{"version":3,"names":[],"mappings":"","sources":["lcp-beacon.js"],"sourcesContent":["!function n(o,c,s){function i(t,e){if(!c[t]){if(!o[t]){var r=\"function\"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);throw(r=new Error(\"Cannot find module '\"+t+\"'\")).code=\"MODULE_NOT_FOUND\",r}r=c[t]={exports:{}},o[t][0].call(r.exports,function(e){return i(o[t][1][e]||e)},r,r.exports,n,o,c,s)}return c[t].exports}for(var l=\"function\"==typeof require&&require,e=0;e<s.length;e++)i(s[e]);return i}({1:[function(e,t,r){\"use strict\";function s(e){return 0<=e.bottom&&0<=e.right&&e.top<=(window.innerHeight||document.documentElement.clientHeight)&&e.left<=(window.innerWidth||document.documentElement.clientWidth)}function i(o){const e=document.querySelectorAll(\"img, video, picture, p, main, div, li, svg\");console.log(\"potentialCandidates\",e);const c=[];return e.forEach(t=>{console.log(\"-------------------\");var e=t.getBoundingClientRect();if(console.log(\"element\",t),console.log(\"rect.width\",e.width),console.log(\"rect.height\",e.height),console.log(\"isIntersecting( rect )\",s(e)),0<e.width&&0<e.height&&s(e)){var r=Math.min(e.width,(window.innerWidth||document.documentElement.clientWidth)-e.left)*Math.min(e.height,(window.innerHeight||document.documentElement.clientHeight)-e.top);console.log(\"element\",t);var n=l(t);if(console.log(\"elementInfo\",n),null!==n){for(let e=0;e<c.length;e++)if(r>c[e].area){c.splice(e,0,{element:t,area:r,elementInfo:n}),c.length=Math.min(o,c.length);break}c.length<o&&c.push({element:t,area:r,elementInfo:n})}}}),c.map(e=>({element:e.element,elementInfo:l(e.element)}))}function l(e){var t=e.nodeName.toLowerCase();const r={type:\"\",src:\"\",srcset:\"\",sizes:\"\",sources:[],bg_set:[],current_src:\"\"};console.log(\"nodeName\",t);if(\"img\"===t&&e.srcset)r.type=\"img-srcset\",r.src=e.src,r.srcset=e.srcset,r.sizes=e.sizes,r.current_src=e.currentSrc;else if(\"img\"===t)r.type=\"img\",r.src=e.src,r.current_src=e.currentSrc;else if(\"video\"===t)r.type=\"img\",e.poster?(r.src=e.poster,r.current_src=e.poster):(r.src=e.querySelector(\"source\").src,r.current_src=e.querySelector(\"source\").src);else if(\"svg\"===t){const n=e.querySelector(\"image\");n&&(r.type=\"img\",r.src=n.getAttribute(\"href\"),r.current_src=n.getAttribute(\"href\"))}else if(\"picture\"===t)r.type=\"picture\",r.src=e.querySelector(\"img\").src,r.sources=Array.from(e.querySelectorAll(\"source\")).map(e=>({srcset:e.srcset,media:e.media}));else{const o=window.getComputedStyle(e,null),c=[o.getPropertyValue(\"background-image\"),getComputedStyle(e,\":after\").getPropertyValue(\"background-image\"),getComputedStyle(e,\":before\").getPropertyValue(\"background-image\")],s=c.filter(e=>\"none\"!==e).join(\"\");if(r.type=\"bg-img\",s.includes(\"image-set(\")&&(r.type=\"bg-img-set\"),!s||\"\"===s)return null;const i=[...s.matchAll(/url\\(\\s*?['\"]?\\s*?(\\S+?)\\s*?[\"']?\\s*?\\)\\s*?([a-zA-Z0-9\\s]*[x|dpcm|dpi|dppx]?)/gi)];r.bg_set=i.map(e=>e[1]?{src:e[1].trim()+(e[2]?\" \"+e[2].trim():\"\")}:{}),r.bg_set.every(e=>\"\"===e.src)&&(r.bg_set=i.map(e=>e[1]?{src:e[1].trim()}:{})),0<r.bg_set.length&&(r.src=r.bg_set[0].src,\"bg-img-set\"===r.type&&(r.src=r.bg_set))}return r}let a=[];async function n(){const e=i(1);0!==e.length?(console.log(\"Estimated LCP element:\",e),a=e.map(e=>({...e.elementInfo,label:\"lcp\"}))):console.log(\"No LCP candidate found.\");for(var t=i(1/0),r=0;r<t.length;r++){var n=t[r].element,o=t[r].elementInfo;(function(e,t){const r=l(e);return null!==r&&(\"img\"===r.type||\"img-srcset\"===r.type||\"video\"===r.type?t.some(e=>e.src===r.src):\"bg-img\"===r.type||\"bg-img-set\"===r.type?t.some(e=>e.src===r.src):\"picture\"===r.type&&t.some(e=>e.src===r.src))})(n,a)||a.push({...o,label:\"above-the-fold\"})}console.log(a);var c=JSON.stringify(a);window.performance_images_json=c;const s=new FormData;s.append(\"action\",\"rocket_lcp\"),s.append(\"rocket_lcp_nonce\",rocket_lcp_data.nonce),s.append(\"url\",rocket_lcp_data.url),s.append(\"is_mobile\",rocket_lcp_data.is_mobile),s.append(\"images\",c),s.append(\"status\",\"success\"),await fetch(rocket_lcp_data.ajax_url,{method:\"POST\",credentials:\"same-origin\",body:s}).then(e=>e.json()).then(e=>{console.log(e)}).catch(e=>{console.error(e)})}\"loading\"!==document.readyState?(console.time(\"extract\"),setTimeout(n,500),console.timeEnd(\"extract\")):document.addEventListener(\"DOMContentLoaded\",async function(){console.time(\"extract\"),setTimeout(n,500),console.timeEnd(\"extract\")})},{}]},{},[1]);"],"file":"lcp-beacon.js"}